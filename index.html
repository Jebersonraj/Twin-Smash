<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Twin Smash</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
  <style>
    body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background: #f0f0f0; }
    canvas { border: 1px solid black; }
  </style>
</head>
<body>
<script>
  let aeroplane;
  let twinTowers = [];
  let score = 0;
  let gameOver = false;
  let groundY;

  function setup() {
    createCanvas(800, 400);
    groundY = height - 50;
    aeroplane = new Aeroplane();
    twinTowers.push(new TwinTower());
  }

  function draw() {
    background(255);

    // Draw ground
    stroke(0);
    line(0, groundY, width, groundY);

    // Update and show aeroplane
    aeroplane.update();
    aeroplane.show();

    // Update and show twin towers (each obstacle is a single twin tower with exactly two vertical structures)
    if (!gameOver) {
      if (frameCount % 60 === 0) {
        twinTowers.push(new TwinTower());
        score += 10;
      }

      for (let i = twinTowers.length - 1; i >= 0; i--) {
        twinTowers[i].update();
        twinTowers[i].show();

        // Collision detection
        if (aeroplane.hits(twinTowers[i])) {
          gameOver = true;
        }

        // Remove twin towers that are off-screen
        if (twinTowers[i].x < -twinTowers[i].w) {
          twinTowers.splice(i, 1);
        }
      }
    }

    // Display score
    textSize(20);
    textAlign(LEFT);
    fill(0);
    text(`Score: ${score}`, 10, 30);

    // Game over screen
    if (gameOver) {
      textSize(32);
      textAlign(CENTER);
      text("Game Over", width / 2, height / 2);
      text(`Score: ${score}`, width / 2, height / 2 + 40);
      text("Press SPACE to restart", width / 2, height / 2 + 80);
      noLoop();
    }
  }

  function keyPressed() {
    if (keyCode === 32) { // Spacebar
      if (gameOver) {
        // Restart game
        twinTowers = [];
        score = 0;
        gameOver = false;
        aeroplane = new Aeroplane();
        twinTowers.push(new TwinTower());
        loop();
      } else {
        aeroplane.jump();
      }
    }
  }

  class Aeroplane {
    constructor() {
      this.x = 50;
      this.y = groundY;
      this.w = 60;
      this.h = 30;
      this.vy = 0;
      this.gravity = 0.8;
      this.jumpStrength = -15;
      this.onGround = true;
    }

    update() {
      if (!this.onGround) {
        this.vy += this.gravity;
        this.y += this.vy;
      }

      if (this.y >= groundY) {
        this.y = groundY;
        this.vy = 0;
        this.onGround = true;
      }
    }

    show() {
      push();
      translate(this.x, this.y - this.h);
      fill(150);
      stroke(0);
      // Aeroplane body
      rect(5, 10, 50, 10, 5); // Rounded rectangle for body
      // Cockpit
      fill(100, 100, 255);
      ellipse(50, 15, 10, 8); // Blue cockpit window
      // Wings
      fill(150);
      triangle(20, 10, 40, 10, 30, 0); // Top wing
      triangle(20, 20, 40, 20, 30, 30); // Bottom wing
      // Tail
      triangle(0, 10, 0, 20, -10, 15); // Tail fin
      // Engine
      fill(100);
      rect(15, 20, 10, 5); // Engine under wing
      pop();
    }

    jump() {
      if (this.onGround) {
        this.vy = this.jumpStrength;
        this.onGround = false;
      }
    }

    hits(tower) {
      return (this.x + this.w > tower.x &&
              this.x < tower.x + tower.w &&
              this.y > tower.y - tower.h &&
              this.y - this.h < tower.y);
    }
  }

  class TwinTower {
    constructor() {
      this.w = 40;
      this.h = 60;
      this.x = width;
      this.y = groundY;
      this.speed = -5;
    }

    update() {
      this.x += this.speed;
    }

    show() {
      push();
      translate(this.x, this.y - this.h);

      // Twin tower: exactly two vertical structures as a single obstacle
      // Left tower
      fill(80); // Darker grey for depth
      rect(0, 0, 15, this.h);
      // Right tower
      fill(100); // Lighter grey
      rect(25, 0, 15, this.h);

      // Windows (staggered pattern)
      fill(180, 180, 255); // Light blue for windows
      for (let y = 5; y < this.h - 5; y += 10) {
        rect(2, y, 5, 4); // Left tower windows
        rect(4, y + 5, 5, 4);
        rect(27, y, 5, 4); // Right tower windows
        rect(29, y + 5, 5, 4);
      }

      // Rooftop details
      fill(50);
      rect(0, 0, 15, 3); // Left tower roof
      rect(25, 0, 15, 3); // Right tower roof

      // Antenna on left tower
      stroke(80);
      line(7.5, 0, 7.5, -12); // Antenna
      ellipse(7.5, -12, 3, 3); // Antenna tip

      pop();
    }
  }
</script>
</body>
</html>